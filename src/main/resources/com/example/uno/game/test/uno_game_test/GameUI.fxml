<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>

<BorderPane id="gameBackground" prefHeight="690.0" prefWidth="900.0" stylesheets="@css/styles.css"
            xmlns="http://javafx.com/javafx/11.0.14-internal"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.example.uno.game.test.uno_game_test.GameController">

    <!-- Top Header with Game Info and Settings/Help Buttons -->
    <top>
        <BorderPane styleClass="header-section">
            <!-- Settings Button (Left) -->
            <left>
                <Button fx:id="settingsBtn" styleClass="icon-button" text="⚙️" onAction="#showSettingsDialog">
                    <BorderPane.margin>
                        <Insets left="10.0" />
                    </BorderPane.margin>
                </Button>
            </left>

            <!-- Game Information (Center) -->
            <center>
                <HBox alignment="CENTER" spacing="10">
                    <Label text="Current Player:" />
                    <Label fx:id="currentPlayerLabel" styleClass="highlight-text" text="Player 1" />
                    <Separator orientation="VERTICAL" />
                    <Label text="Direction:" />
                    <Label fx:id="directionIndicator" styleClass="highlight-text" text="Clockwise" />
                    <Separator orientation="VERTICAL" />
                    <Label text="Cards Left:" />
                    <Label fx:id="cardsLeftCount" styleClass="highlight-text" text="00" />
                </HBox>
            </center>

            <!-- Help Button (Right) -->
            <right>
                <Button fx:id="helpBtn" styleClass="icon-button" text="❓" onAction="#showHelpDialog">
                    <BorderPane.margin>
                        <Insets right="10.0" />
                    </BorderPane.margin>
                </Button>
            </right>

            <padding>
                <Insets bottom="10.0" top="10.0" />
            </padding>
        </BorderPane>
    </top>

    <!-- Main Game Area -->
    <center>
        <VBox fx:id="gamePane" alignment="CENTER" spacing="10" styleClass="game-area">
            <padding>
                <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
            </padding>

            <!-- Opponents Section -->
            <ScrollPane fitToWidth="true" styleClass="opponent-scroll">
                <GridPane fx:id="opponentArea" alignment="CENTER" hgap="10" vgap="10" styleClass="opponent-section">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="25.0" />
                        <ColumnConstraints percentWidth="25.0" />
                        <ColumnConstraints percentWidth="25.0" />
                        <ColumnConstraints percentWidth="25.0" />
                    </columnConstraints>

                    <!-- Opponent slots (configured for 8 total) -->
                    <!-- Row 1 - First 4 opponents -->
                    <VBox alignment="CENTER" spacing="5" styleClass="opponent-container"
                          GridPane.columnIndex="0" GridPane.rowIndex="0">
                        <Label styleClass="player-name" text="Opponent 1" />
                        <ScrollPane hbarPolicy="AS_NEEDED" vbarPolicy="NEVER"
                                    styleClass="opponent-hand-scroll" maxWidth="150">
                            <HBox fx:id="opponent1Hand" alignment="CENTER" spacing="2"
                                  styleClass="card-hand" />
                        </ScrollPane>
                        <Label fx:id="opponent1CardCount" text="7 cards" />
                    </VBox>

                    <!-- Adding remaining opponent containers -->
                    <VBox alignment="CENTER" spacing="5" styleClass="opponent-container"
                          GridPane.columnIndex="1" GridPane.rowIndex="0">
                        <Label styleClass="player-name" text="Opponent 2" />
                        <ScrollPane hbarPolicy="AS_NEEDED" vbarPolicy="NEVER"
                                    styleClass="opponent-hand-scroll" maxWidth="150">
                            <HBox fx:id="opponent2Hand" alignment="CENTER" spacing="2"
                                  styleClass="card-hand" />
                        </ScrollPane>
                        <Label fx:id="opponent2CardCount" text="7 cards" />
                    </VBox>

                    <VBox alignment="CENTER" spacing="5" styleClass="opponent-container"
                          GridPane.columnIndex="2" GridPane.rowIndex="0">
                        <Label styleClass="player-name" text="Opponent 3" />
                        <ScrollPane hbarPolicy="AS_NEEDED" vbarPolicy="NEVER"
                                    styleClass="opponent-hand-scroll" maxWidth="150">
                            <HBox fx:id="opponent3Hand" alignment="CENTER" spacing="2"
                                  styleClass="card-hand" />
                        </ScrollPane>
                        <Label fx:id="opponent3CardCount" text="7 cards" />
                    </VBox>

                    <VBox alignment="CENTER" spacing="5" styleClass="opponent-container"
                          GridPane.columnIndex="3" GridPane.rowIndex="0">
                        <Label styleClass="player-name" text="Opponent 4" />
                        <ScrollPane hbarPolicy="AS_NEEDED" vbarPolicy="NEVER"
                                    styleClass="opponent-hand-scroll" maxWidth="150">
                            <HBox fx:id="opponent4Hand" alignment="CENTER" spacing="2"
                                  styleClass="card-hand" />
                        </ScrollPane>
                        <Label fx:id="opponent4CardCount" text="7 cards" />
                    </VBox>

                    <!-- Row 2 - Additional 4 opponents -->
                    <VBox alignment="CENTER" spacing="5" styleClass="opponent-container"
                          GridPane.columnIndex="0" GridPane.rowIndex="1">
                        <Label styleClass="player-name" text="Opponent 5" />
                        <ScrollPane hbarPolicy="AS_NEEDED" vbarPolicy="NEVER"
                                    styleClass="opponent-hand-scroll" maxWidth="150">
                            <HBox fx:id="opponent5Hand" alignment="CENTER" spacing="2"
                                  styleClass="card-hand" />
                        </ScrollPane>
                        <Label fx:id="opponent5CardCount" text="7 cards" />
                    </VBox>

                    <VBox alignment="CENTER" spacing="5" styleClass="opponent-container"
                          GridPane.columnIndex="1" GridPane.rowIndex="1">
                        <Label styleClass="player-name" text="Opponent 6" />
                        <ScrollPane hbarPolicy="AS_NEEDED" vbarPolicy="NEVER"
                                    styleClass="opponent-hand-scroll" maxWidth="150">
                            <HBox fx:id="opponent6Hand" alignment="CENTER" spacing="2"
                                  styleClass="card-hand" />
                        </ScrollPane>
                        <Label fx:id="opponent6CardCount" text="7 cards" />
                    </VBox>

                    <VBox alignment="CENTER" spacing="5" styleClass="opponent-container"
                          GridPane.columnIndex="2" GridPane.rowIndex="1">
                        <Label styleClass="player-name" text="Opponent 7" />
                        <ScrollPane hbarPolicy="AS_NEEDED" vbarPolicy="NEVER"
                                    styleClass="opponent-hand-scroll" maxWidth="150">
                            <HBox fx:id="opponent7Hand" alignment="CENTER" spacing="2"
                                  styleClass="card-hand" />
                        </ScrollPane>
                        <Label fx:id="opponent7CardCount" text="7 cards" />
                    </VBox>

                    <VBox alignment="CENTER" spacing="5" styleClass="opponent-container"
                          GridPane.columnIndex="3" GridPane.rowIndex="1">
                        <Label styleClass="player-name" text="Opponent 8" />
                        <ScrollPane hbarPolicy="AS_NEEDED" vbarPolicy="NEVER"
                                    styleClass="opponent-hand-scroll" maxWidth="150">
                            <HBox fx:id="opponent8Hand" alignment="CENTER" spacing="2"
                                  styleClass="card-hand" />
                        </ScrollPane>
                        <Label fx:id="opponent8CardCount" text="7 cards" />
                    </VBox>
                </GridPane>
            </ScrollPane>

            <!-- Game Table Section -->
            <StackPane styleClass="game-table" VBox.vgrow="ALWAYS">
                <!-- Deck and Discard Pile -->
                <HBox alignment="CENTER" spacing="20">
                    <!-- Draw Pile -->
                    <VBox alignment="CENTER" spacing="5" styleClass="card-pile">
                        <Label styleClass="pile-label" text="DRAW PILE" />
                        <StackPane styleClass="deck-container">
                            <ImageView fx:id="deckView" fitHeight="160" fitWidth="110"
                                       preserveRatio="true" styleClass="card-image"
                                       onMouseClicked="#handleDrawCard">
                                <effect>
                                    <DropShadow />
                                </effect>
                            </ImageView>
                            <Label fx:id="deckCountLabel" styleClass="deck-count" text="52" />
                        </StackPane>
                        <Button fx:id="drawCardBtn" styleClass="game-button" text="Draw Card"
                                visible="false" managed="false" onAction="#handleDrawCard" />
                    </VBox>

                    <!-- Discard Pile -->
                    <VBox alignment="CENTER" spacing="5" styleClass="card-pile">
                        <Label styleClass="pile-label" text="DISCARD PILE" />
                        <StackPane styleClass="discard-container">
                            <ImageView fx:id="discardPileView" fitHeight="160" fitWidth="110"
                                       preserveRatio="true" styleClass="card-image">
                                <effect>
                                    <DropShadow />
                                </effect>
                            </ImageView>
                        </StackPane>
                    </VBox>
                </HBox>

                <!-- Game status overlay -->
                <VBox fx:id="statusOverlay" alignment="CENTER" styleClass="status-overlay" visible="false">
                    <Label fx:id="statusOverlayLabel" styleClass="overlay-text" text="SKIP!" />
                </VBox>
            </StackPane>

            <!-- Game Actions -->
            <HBox alignment="CENTER" spacing="15" styleClass="action-area">
                <Button fx:id="unoButton" styleClass="uno-button" text="UNO!" onAction="#callUno" />
                <Button fx:id="skipButton" styleClass="game-button" text="Skip Turn"
                        disable="true" onAction="#skipTurn" />
                <Button fx:id="challengeButton" styleClass="game-button" text="Challenge"
                        onAction="#challengeUno" />
            </HBox>

            <!-- Status Message -->
            <Label fx:id="statusLabel" styleClass="status-text"
                   text="Your turn! Play a card or draw from the deck." />

            <!-- Player Hand -->
            <VBox spacing="5" styleClass="player-section">
                <Label styleClass="player-name" text="Your Hand" />
                <ScrollPane fx:id="yourHandScrollPane" fitToWidth="true" hbarPolicy="AS_NEEDED" vbarPolicy="NEVER" pannable="true" styleClass="hand-scroll">
                    <HBox fx:id="playerHand" alignment="CENTER" spacing="10" styleClass="player-hand" />
                </ScrollPane>
            </VBox>
        </VBox>
    </center>
</BorderPane>